@using Microsoft.AspNetCore.Identity
@using Afilhado4Patas.Data;

@model Afilhado4Patas.Data.Utilizadores

@inject SignInManager<Utilizadores> SignInManager
@inject UserManager<Utilizadores> UserManager
@inject ApplicationDbContext Context
@{
    ViewData["Title"] = "Perfil";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<br />
<br />
<br />
<br />
<h2> Perfil de @Html.DisplayFor(model => model.Perfil.FirstName) @Html.DisplayFor(model => model.Perfil.LastName)</h2>

<div>
    <dl class="dl-horizontal">
        @{Utilizadores user = Context.Utilizadores.Where(u => u.Email == UserManager.GetUserName(User)).FirstOrDefault();
            Perfil perfil = Context.PerfilTable.Where(p => p.Id == user.PerfilId).FirstOrDefault();
            if (perfil.Photo != null)
            {
                string src = "/Utilizadores/" + user.Id + "/" + perfil.Photo;
                <img src = "@src" />
            }
            else
            {
                <img id="imagem_perfil" src="~/images/default.jpg" />
            }
        }
        <br />
        <br />
        <dt>
            Dados Pessoais
        </dt>
        <br />
        <br />
        <dt>
            @Html.DisplayNameFor(model => model.Perfil.FirstName)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Perfil.FirstName)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Perfil.LastName)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Perfil.LastName)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Email)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Email)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Perfil.Genre)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Perfil.Genre)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Perfil.Birthday)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Perfil.Birthday)
        </dd>
        <br />
        <dt>
            Morada
        </dt>
        <br />
        <br />
        <dt>
            @Html.DisplayNameFor(model => model.Perfil.City)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Perfil.City)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Perfil.Street)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Perfil.Street)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Perfil.Postalcode)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Perfil.Postalcode)
        </dd>
    </dl>
</div>
<div>
    <a asp-controller="Responsavel" asp-action="PerfilEditarDadosPessoais" asp-route-id="@UserManager.GetUserName(User)">Editar Dados Pessoais</a>
</div>
<div>
    <a asp-controller="Responsavel" asp-action="PerfilEditarMorada" asp-route-id="@UserManager.GetUserName(User)">Editar Morada</a>
</div>
<div>
    <a asp-controller="Responsavel" asp-action="PerfilEditarPalavraPasse" asp-route-id="@UserManager.GetUserName(User)">Alterar Palavra-Passe</a>
</div>
<div>
    <a asp-controller="Responsavel" asp-action="PerfilEditarFotoPerfil" asp-route-id="@UserManager.GetUserName(User)">Alterar Foto de Perfil</a>
</div>
<div>
    <a asp-controller="Responsavel" asp-action="ListaTarefas" asp-route-id="@UserManager.GetUserName(User)">Tarefas</a>
</div>
<div>
    <a asp-controller="Responsavel" asp-action="ListaFuncionarios" asp-route-id="@UserManager.GetUserName(User)">Funcionários</a>
</div>




